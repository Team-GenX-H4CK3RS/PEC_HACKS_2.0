(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[458],{3708:function(e,t,a){Promise.resolve().then(a.bind(a,7621))},7621:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var n=a(7437),s=a(2265),r=a(5260),c=a.n(r),l=a(7637);let o="http://192.168.248.44:5500";function i(){let[e,t]=(0,s.useState)(),[a,r]=(0,s.useState)([]),[i,u]=(0,s.useState)(),[d,h]=(0,s.useState)(),[f,p]=(0,s.useState)(),[m,g]=(0,s.useState)("en"),[w,x]=(0,s.useState)(),[,y]=(0,s.useState)([]),[b,j]=(0,s.useState)(!1),S=(0,l.Z)(),v=(0,s.useRef)(null),N=function(){let e=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await fetch(o+e,t);if(!a.ok)throw Error("HTTP error! Status: ".concat(a.status));return a.json()};return{getLanguages:async()=>await e("/languages"),translate:async(e,t)=>{let a=await fetch("".concat(o,"/translate"),{body:JSON.stringify({text:t,lang_code:e}),method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}});return await a.json()}}}();(0,s.useEffect)(()=>{let a=async()=>{t(await S.medchat.newChat())},n=async()=>{h(await N.getLanguages())},s=async()=>{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new(c())(e);if(!t)return;t.mimeType="audio/wav",t.ondataavailable=function(e){y(t=>[...t,e])};let a=t.stop;t.stop=async()=>{a(),y(e=>{var t;return(t=new Blob(e,{type:"audio/wav"}),new Promise((e,a)=>{let n=new FileReader;n.onloadend=()=>{e(n.result.split(",")[1])},n.onerror=()=>{a("Reader Error")},n.readAsDataURL(t)})).then(x),[]}),j(!1)},p(t)};d&&0!==d.length||n(),f||s(),e||a()},[]),(0,s.useEffect)(()=>{(async()=>{w&&u(await S.s2t.convertSpeechToText(w))})()},[w]);let T=async e=>{let t=document.getElementById("med-chat-bot-audio-".concat(e));t&&await t.play()},C=async()=>{if(!e||!i||0===i.trim().length)return;let t=await S.medchat.send(e,i),n=await N.translate(m,t);"en"!==m&&(t=n.result),r([...a,{content:i,src:"user"},{content:t,src:"bot",audio:n.audio}]),u(void 0)};return(0,s.useEffect)(()=>{v&&v.current.scroll({behavior:"instant",top:v.current.scrollHeight})},[a,v]),(0,n.jsxs)("div",{className:"p-4 flex flex-col h-full items-center space-y-2 select-none",children:[(0,n.jsxs)("div",{className:"h-12 border-b w-full flex items-center",children:[(0,n.jsx)("div",{className:"flex-grow"}),d?(0,n.jsxs)("label",{className:"flex items-center",children:[(0,n.jsx)("p",{className:"pr-2",children:"Language"}),(0,n.jsx)("select",{className:"px-3 py-1 rounded-xl overflow-hidden",value:m,onChange:e=>g(e.target.value),children:d.map((e,t)=>(0,n.jsx)("option",{value:e[1],children:e[0]},t))})]}):""]}),(0,n.jsx)("div",{className:"flex-grow overflow-y-auto flex flex-col p-4 space-y-2",ref:v,children:a.map((e,t)=>(0,n.jsxs)("div",{className:"px-6 py-2 rounded-xl w-fit relative ".concat("user"===e.src?"self-end bg-teal-100":"self-start bg-slate-100"),children:[(0,n.jsx)("p",{className:"font-bold ".concat("user"===e.src?"text-right":"text-left"),children:"user"===e.src?"You":"Med Bot"}),(0,n.jsx)("p",{children:e.content}),e.audio?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"absolute right-2 top-2 w-8 h-8 flex items-center justify-center bg-teal-700 rounded-full text-white",onClick:()=>T(t),children:(0,n.jsx)("span",{className:"material-symbols-rounded",children:"volume_up"})}),(0,n.jsx)("audio",{src:function(e){let t=new Blob([function(e){let t=atob(e),a=new Uint8Array(t.length);for(let e=0;e<t.length;e++)a[e]=t.charCodeAt(e);return a.buffer}(e)],{type:"audio/mp3"});return window.URL.createObjectURL(t)}(e.audio),id:"med-chat-bot-audio-".concat(t)})]}):""]},t))}),(0,n.jsxs)("div",{className:"flex items-center bg-slate-100 w-full px-2 py-1 space-x-2",children:[(0,n.jsx)("label",{className:"flex flex-col items-stretch w-full",children:(0,n.jsx)("textarea",{className:"appearance-none px-3 py-1 capitalize rounded-xl border-2 border-slate-300 focus:outline-teal-600 transition w-full min-h-[3rem]",value:i,placeholder:"Start chatting with the chat bot...",onChange:e=>u(e.target.value)})}),(0,n.jsx)("button",{className:"flex items-center justify-center w-12 h-12 font-bold p-2 space-x-2 rounded-full bg-teal-700 text-white disabled:bg-slate-800 ".concat(b?"bg-red-600":"bg-teal-700"),disabled:!f,onClick:()=>{b?f&&f.stop():f&&(f.start(1e4),j(!0),u(""))},children:(0,n.jsx)("span",{className:"material-symbols-rounded msr-bold text-3xl",children:b?"stop_circle":"mic"})}),(0,n.jsx)("button",{className:"flex items-center justify-center w-12 h-12 font-bold p-2 space-x-2 rounded-full bg-teal-700 text-white",onClick:C,children:(0,n.jsx)("span",{className:"material-symbols-rounded msr-bold text-3xl",children:"send"})})]})]})}},7637:function(e,t,a){"use strict";function n(){let e="http://192.168.248.44:5000/",t=async function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=await fetch(e+t,a);if(!n.ok)throw Error("HTTP error! Status: ".concat(n.status));return n.json()};return{ngos:{getStates:async()=>await t("ngos/states"),getDistricts:async e=>await t("ngos/states/".concat(e,"/districts")),getSectors:async()=>await t("ngos/sectors"),search:async(e,a,n)=>{let s=new URLSearchParams({state:e,district:a,sectors:n?n.join(","):void 0});return await t("ngos/search?".concat(s.toString()))}},gmaps:{getNearByPlaces:async(e,a)=>{let n=new URLSearchParams({location:e.join(","),place:a}),s=await t("gmaps/nearbyplaces?".concat(n.toString()));return console.log(s),s.results},getNearByPlaceDetailsById:async e=>{let a=new URLSearchParams({place_id:e}),n=await t("gmaps/nearbyplaces/details?".concat(a.toString()));return console.log(n.result),n.result},getRoutes:async(e,a)=>{let n=new URLSearchParams({origin:e.join(","),dest:a.join(",")}),s=await t("gmaps/routes?".concat(n.toString()));return console.log(s),s.result}},medchat:{newChat:async()=>(await t("medchat/new")).sessionId,send:async(t,a)=>{let n=await fetch("".concat(e,"medchat/send"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:t,msg:a})});return(await n.json()).result},closeChat:async t=>{await fetch("".concat(e,"medchat/close"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:t})})}},s2t:{convertSpeechToText:async t=>{let a=await fetch("".concat(e,"speechttext"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({audio:t})});return(await a.json()).text}}}}a.d(t,{Z:function(){return n}})}},function(e){e.O(0,[260,971,117,744],function(){return e(e.s=3708)}),_N_E=e.O()}]);